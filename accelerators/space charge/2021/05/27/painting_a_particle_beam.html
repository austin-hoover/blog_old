<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Painting a particle beam | Austin Hoover</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Painting a particle beam" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="With a high-tech paint brush." />
<meta property="og:description" content="With a high-tech paint brush." />
<link rel="canonical" href="https://austin-hoover.github.io/blog/accelerators/space%20charge/2021/05/27/painting_a_particle_beam.html" />
<meta property="og:url" content="https://austin-hoover.github.io/blog/accelerators/space%20charge/2021/05/27/painting_a_particle_beam.html" />
<meta property="og:site_name" content="Austin Hoover" />
<meta property="og:image" content="https://austin-hoover.github.io/blog/images/target.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-27T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://austin-hoover.github.io/blog/accelerators/space%20charge/2021/05/27/painting_a_particle_beam.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://austin-hoover.github.io/blog/accelerators/space%20charge/2021/05/27/painting_a_particle_beam.html"},"image":"https://austin-hoover.github.io/blog/images/target.png","headline":"Painting a particle beam","dateModified":"2021-05-27T00:00:00-05:00","datePublished":"2021-05-27T00:00:00-05:00","description":"With a high-tech paint brush.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://austin-hoover.github.io/blog/feed.xml" title="Austin Hoover" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Austin Hoover</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/_pages/about.html">About</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Painting a particle beam</h1><p class="page-description">With a high-tech paint brush.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-27T00:00:00-05:00" itemprop="datePublished">
        May 27, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      14 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#accelerators">accelerators</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#space charge">space charge</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#A-quick-tour-of-the-SNS">A quick tour of the SNS </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Ion-source,-front-end,-and-linac">Ion source, front end, and linac </a></li>
<li class="toc-entry toc-h3"><a href="#HEBT,-injection-region,-and-accumulator-ring">HEBT, injection region, and accumulator ring </a></li>
<li class="toc-entry toc-h3"><a href="#RTBT-and-target">RTBT and target </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Injection">Injection </a>
<ul>
<li class="toc-entry toc-h3"><a href="#H$^-$-charge-exchange">H$^-$ charge exchange </a></li>
<li class="toc-entry toc-h3"><a href="#Dealing-with-extra-particles">Dealing with extra particles </a></li>
<li class="toc-entry toc-h3"><a href="#Is-Liouville's-theorem-violated?">Is Liouville&#39;s theorem violated? </a></li>
<li class="toc-entry toc-h3"><a href="#The-future:-lasers">The future: lasers </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Phase-space-painting">Phase space painting </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Time-dependent-kicker-magnets">Time-dependent kicker magnets </a></li>
<li class="toc-entry toc-h3"><a href="#Production-painting">Production painting </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Conclusion">Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-05-27-painting_a_particle_beam.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post explains an imporant step in the creation of intense proton beams in the Spallation Neutron Source (SNS). The method is often called "phase space painting" or simply "painting", hence the title.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-quick-tour-of-the-SNS">
<a class="anchor" href="#A-quick-tour-of-the-SNS" aria-hidden="true"><span class="octicon octicon-link"></span></a>A quick tour of the SNS<a class="anchor-link" href="#A-quick-tour-of-the-SNS"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is a great scene in the otherwise disappointing movie <em>Iron Man 2</em> in which Tony Stark builds a particle accelerator in his house.

</p>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/y0brSA1cyzw" frameborder="0" allowfullscreen=""></iframe>
</center>
<br>
<p>The movie makes it look like pretty complicated process, but modern large-scale accelerators are immensely more complicated than the one Stark builds. In fact, I'm actually quite amazed that such machines have been built <em>and work as expected</em>. One example is the SNS (overhead diagram below).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/images_2021-05-27/sns.png" alt="" style="max-width: 100%px">
    
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal of the SNS is to produce extremely bright, pulsed neutron beams for neutron scattering experiments. These neutrons are produced through the process of <a href="https://inis.iaea.org/collection/NCLCollectionStore/_Public/23/015/23015552.pdf">spallation</a> by colliding a proton beam with a Mercury target. The power of the proton beam must be as high as possible to maximize the brightness of the neutron beam, and creating such a high-power beam is a multi-step process; particles must travel all the way from the ion source on the far left to the target on the far right, passing though many different sections on their journey. We're first going to mention the basic function of each of these sections, and then we're going to look in more detail at the relatively small but extremely important <em>injection region</em> of the machine. This is the point where the HEBT meets the accumulator ring in the above diagram.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ion-source,-front-end,-and-linac">
<a class="anchor" href="#Ion-source,-front-end,-and-linac" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ion source, front end, and linac<a class="anchor-link" href="#Ion-source,-front-end,-and-linac"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The beam originates in the ion source. As explained later, the beam is not actually made of protons at this point, but is instead made of H$^-$ ions (proton + two electrons). The ion source consists of a vacuum chamber filled with gas, and an oscillating electric field which ionizes the gas to form a glowing, pink plasma. The H$^-$ particles are then extracted from the plasma; I asked one of the researchers at SNS (who doesn't work on the ion source) how exactly these ions are extracted, and they said it's "black magic", so I guess it's not straightforward.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/images_2021-05-27/ion_source.png" alt="" style="max-width: 500px">
    
    
</figure>
</p>
<figcaption>Diagram of the SNS ion source. From <a class="citation" href="#Henderson2014">[1]</a>.</figcaption>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The H$^-$ beam is then accelerated to around 2.5 MeV, focused, and "chopped" into 1000 <em>minipulses</em>. Each minipulse is about 700 nanoseconds long, and they're separated by a gap of about 300 nanoseconds. The dynamics in this region are greatly affected by space charge, and it's hard to know exactly what the beam looks like when it exits the ion source. The SNS has built an exact replica of this front end called the Beam Test Facility (BTF) which is currently being used to better understand this section of the machine <a class="citation" href="#Cathey2018">[2]</a>.</p>
<p>Each minipulse is now ready to be accelerated. The next section of the machine is called the linac (linear accelerator), a long, straight section whose purpose is to accelerate the minipulses up to 1 GeV (around 90% of the speed of light) while maintaining an acceptable beam size. This is done using a series of normal-conducting and superconducting radio-frequency cavities. There is a lot to talk about in the linac, but I'll stop here since I don't have much knowledge of this area of the machine (yet).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HEBT,-injection-region,-and-accumulator-ring">
<a class="anchor" href="#HEBT,-injection-region,-and-accumulator-ring" aria-hidden="true"><span class="octicon octicon-link"></span></a>HEBT, injection region, and accumulator ring<a class="anchor-link" href="#HEBT,-injection-region,-and-accumulator-ring"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The high-energy beam transport (HEBT, pronounced "hebbet") guides the fully accelerated minipulse from the linac to the left edge of the accumulator ring. At this point, all the ions in the minipulse are converted to protons and <em>injected</em> into the accumulator ring (more on this in the next section). The minpulse takes 1 microsecond to travel around the ring, at which point a second minipulse is injected and the circulating beam doubles in intensity. This repeats 1000 times over the course of one millisecond until the final beam, called a <em>pulse</em>, contains around $1.5 \times 10^{14}$ protons. That seems like a lot until you consider that Avagadros number is one billion times larger! 60 of these pulses contains about the same energy as a stick of dynamite.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="RTBT-and-target">
<a class="anchor" href="#RTBT-and-target" aria-hidden="true"><span class="octicon octicon-link"></span></a>RTBT and target<a class="anchor-link" href="#RTBT-and-target"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, the entire pulse is extracted from the ring and travels down the ring-target-beam-transport (RTBT) in which it is directed to the Mercury target, producing neutrons. These neutrons are then cooled and transported to various instrumental halls for use in neutron scattering experiments.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images_2021-05-27/target.png" alt="" title="Protons (yellow) bombard the Mercury target to produce neutrons (blue). Credit: Jill Hemman."></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Injection">
<a class="anchor" href="#Injection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Injection<a class="anchor-link" href="#Injection"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we're going to discuss the injection region in more detail (see image below). Somehow, all the negatively charged ions need to be converted to positively charge protons, and the beam from the linac needs to merge with the circulating beam in the ring without derailing its trajectory; it's as if the ions were trying to merge onto a busy highway. The specific method used at SNS is <em>charge exchange</em> injection, which we discuss first. We'll then move on to discuss <em>phase space painting</em>, which is used to mitigate the effects of space charge in intense beams.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/images_2021-05-27/injection_region4.png" alt="" style="max-width: 300px">
    
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="H$^-$-charge-exchange">
<a class="anchor" href="#H%24%5E-%24-charge-exchange" aria-hidden="true"><span class="octicon octicon-link"></span></a>H$^-$ charge exchange<a class="anchor-link" href="#H%24%5E-%24-charge-exchange"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider two oppositely charged beams which have the same kinetic energy but opposite charges. Also assume that we're dealing with point particles which do not interact with each other and have no transverse velocity. If these beams are sent thought a dipole magnet, their paths will be bent in opposite directions with the same radius of curvature. If they additionally have opposite angles of incidence, there will be a point in the dipole at which both beams are moving parallel to each other. Now imagine that, at this very instance, the charge of all the particles in one of the beams changes sign. The two beams would then be identical and would continue along the same trajectory, although there may be an offset. It's possible to also choose the horizontal and vertical positions of the two beams such that they converge and travel along identical paths.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/images_2021-05-27/bend.png" alt="" style="max-width: 400px">
    
    
</figure>
</p>
<figcaption>Oppositely charged particles are bent in different directions in a dipole magnetic field.</figcaption>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The idea is to do this with the two beams in the SNS: the negatively charged H$^-$ beam the linac and the positively charged proton beam which is circulating in the ring. Russian scientists developed a method to do this in the 1960's using a thin foil which <em>strips</em> the two electrons from the Hydrogen ions but leaves the protons. The foil properties need to be chosen carefully. It needs to be the right material and thick enough to have a high stripping efficiency (number of ions successfully stripped divided by total number of ions), but not so thick that most of the protons are scattered. It also needs to be able to survive high numbers of foil hits without being destroyed. Thus, the choice of foil parameters requires a knowledge of materials science. The SNS uses diamond foils as in the following images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images_2021-05-27/foil.png" alt="" title="Stripper foil used for charge-exchange injection at the SNS."></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dealing-with-extra-particles">
<a class="anchor" href="#Dealing-with-extra-particles" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dealing with extra particles<a class="anchor-link" href="#Dealing-with-extra-particles"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some of the H$^-$ hold on to their electrons as they pass through the foil, and some only lose one electron, becoming H$^0$. To deal with these particles, the foil is placed in a dipole field. Because many of the H$^0$ particles are in excited states, it is likely that their electron will be stripped by the magnetic field soon after the foil; this is known as <em>Lorentz stripping</em>. So a lot of these will become protons and join the circulating beam, just a bit late to the party. The remaining non-protons continue away from the ring and encounter <em>another foil</em> which removes the electrons so that they can be guided to a beam dump. There is also the need to catch the stripped electrons, which can have significant kinetic energies, but I won't discuss that here.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Is-Liouville's-theorem-violated?">
<a class="anchor" href="#Is-Liouville's-theorem-violated?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Is Liouville's theorem violated?<a class="anchor-link" href="#Is-Liouville's-theorem-violated?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Those familiar with Liouville's theorem may object to the charge-exchange method. Liouville's theorem applies to any system which obeys Hamilton's equations:</p>
<p>
$$ \dot{\mathbf{q}} = \frac{\partial\mathbf{H}}{\partial\mathbf{p}} ,\quad \dot{\mathbf{p}} = -\frac{\partial\mathbf{H}}{\partial\mathbf{q}},$$
</p>
<p>where $\mathbf{q}$ are the coordinates and $\mathbf{p}$ are the momenta. Imagine we took a volume of phase space and started to fill it with particles; in fact, we fill all of the infinite number of points inside the volume. Then we evolve the system in time. The final distribution of particles may have changed shape, but Liouville's theorem states that its volume will not have changed. Mathematically, this is due to Hamilton's equations being equivalent to a coordinate transformation whose Jacobian has a determinant equal to one. So the objection is that the phase space volume of the entire system (linac beam + circulating beam) seems to <em>decrease</em> when they are merged, i.e., the linac beam is stacked directly on top of the circulating beam, and that this should be disallowed by Liouville's theorem. Is this true?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I read a paper by A. Ruggiero which helped to clarify this issue <a class="citation" href="#Ruggiero1978">[3]</a>. The key point is that Liouville's theorem deals with <em>distributions</em> rather than finite numbers of particles. Any finite number of particles will not fill up every point in phase space, so there is nothing preventing another finite number of particles from being stacked on top of the original group. The real limitation is how to stack the two groups, which is where the charge exchange technique becomes necessary.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-future:-lasers">
<a class="anchor" href="#The-future:-lasers" aria-hidden="true"><span class="octicon octicon-link"></span></a>The future: lasers<a class="anchor-link" href="#The-future:-lasers"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A major research project at the SNS is to demonstrate laser-assisted charge exchange (LACE), in which a laser is used to strip the electrons intead of a foil. This would overcome the scattering losses from foils as well as their finite lifetimes, and is a very promising direction as machines continue to increase in power <a class="citation" href="#Cousineau2017">[4]</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Phase-space-painting">
<a class="anchor" href="#Phase-space-painting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Phase space painting<a class="anchor-link" href="#Phase-space-painting"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the last section, we assumed that the particles didn't interact with each other, but in reality, space charge is the fundamental limit on the intensity in high-power hadron accelerators. Injecting at the same position in space will cause the beam to become very dense, and the beam will then expand due to the increased space charge forces. It's likely that this will produce a very non-uniform distribution which, as mentioned in <a href="https://austin-hoover.github.io/blog/accelerators/space%20charge/differential%20equations/publications/2021/05/13/matched_Danilov_dist.html">this post</a>, is undesirable. This is the motivation for so-called <em>phase space painting</em> or simply <em>painting</em>. The idea is to change the transverse position and momentum of the circulating beam over time in order to slowly fill or "paint" the beam in phase space and hopefully produce a more uniform density beam. Another motivation for painting is to avoid excessive foil hits, since these lead to shorter foil lifetimes and also beam scattering.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Time-dependent-kicker-magnets">
<a class="anchor" href="#Time-dependent-kicker-magnets" aria-hidden="true"><span class="octicon octicon-link"></span></a>Time-dependent kicker magnets<a class="anchor-link" href="#Time-dependent-kicker-magnets"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a zoomed in view of the injection region.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>
<figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/images_2021-05-27/injection_region1.png" alt="" style="max-width: 600px">
    
    
</figure>

<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The blue elements which aren't labeled in the ring are just quadrupoles used to focus the beam. This leaves the "bump" or "kicker" magnets and the "Chicane" magnets. These are both dipoles, but they are a bit different. The chicane dipoles provide a fixed horizontal bump to the closed orbit so that it is aligned with the beam from the linac. The kickers, on the other hand, can move the closed orbit horizontally or vertically, and they're time-dependent. Regarding the latter point, the current from the magnet's power supply, and therefore the magnetic field, can be varied during injection. Let's take a look at the vertical closed orbit with the kickers turned on (black line).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images_2021-05-27/injection_region.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dark blue boxes are quadrupoles, the red boxes are Chicane dipoles, and the remaining elements are the horizontal (green) and vertical (yellow) kickers. Without the kickers, the closed orbit will just go straight through the center of each magnet, and a similar thing holds in the horizontal plane. Thus, we have control over the horizontal and vertical position of the circulating beam relative to the injected beam. But there is also the possibility that the trajectory is converging or diverging at the foil, so we also have control over the horizontal and vertical circulating beam <em>slope</em> relative to the injected beam. These eight kickers therefore give full control over the transverse phase space coordinates of the circulating beam relative to the injected beam at every point during the injection.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Production-painting">
<a class="anchor" href="#Production-painting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Production painting<a class="anchor-link" href="#Production-painting"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The time-dependence of each kicker magnet is determined by a waveform which determines the current given to its power supply as a function of time; for example, we could have a linear waveform, square root waveform, etc. Choosing these waveforms amounts to choosing the initial and final position/slope of the circulating beam, as well as the rate of change in the position/slope. The standard "production" scheme in the SNS (as in neutron production) is to use a square root waveform so that</p>
<p>
$$ x_{inj} - x_{co} = (x_{max} - x_{min}) \sqrt{t / t_{max}} + x_{min}, $$


$$ y_{inj} - y_{co} = (y_{max} - y_{min}) \sqrt{t / t_{max}} + y_{min}, $$
</p>
<p>where the <em>co</em> subscript means "closed orbit" and <em>inj</em> means "injected beam". The slope of the circulating beam is kept at zero in this scheme.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's probably best to use some visualizations at this point. I simulated the injection painting using <a href="https://github.com/austin-hoover/py-orbit">PyORBIT</a>; included in this simulation are effects such as space charge, nonlinear magnetic fringe fields, scattering from the foil, etc., so the results should be somewhat similar to the real world. 260 simulation particles were injected on each turn to give a final number of 260,000, which should provide good statistics for the space charge solver which operates on a $128 \times 128$ transverse grid. The whole simulation took a few hours to run on my laptop. (The space charge solver I used makes some approximations in the longitudinal dimension; a more realistic solver will push the execution time from a few hours to a few days.)</p>
<p>The following animation shows this simulated beam at the injection point during the first 35 turns in the ring. The off-diagonal subplots show the correlations between the four phase space variables (a sample of 10,000 particles is used) and the on-diagonal subplots show the histograms for each variable. The foil location is shown by the red dot in the $x$-$y$ plane.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- ![](images_next/painting_short.mov) -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images_2021-05-27/painting_short.mov" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Keep in mind that each little cluster is actually a bunch of particles; it's hard to resolve because the width is small compared to the full beam. Notice that, since the circulating and injected beams are offset to begin with, the injected particles start to trace ellipses in the $x$-$x'$ and $y$-$y'$ projections. The frequencies at which the particles oscillate in each plane are not the same, so the path in $x$-$y$ space is constantly changing, eventually filling a rectangular region. The next animation shows the beam over all 1000 turns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images_2021-05-27/painting_long.mov" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the beam size is slowly increasing, and also that the density is steadily increasing; this is only apparent from the histograms since I'm using a random sample of particles in the scatter plots. Space charge, as well as nonlinear effects, tend to round the hard edges of the the originally rectangular beam. The beam also exhibits some interesting dynamics after turn 100, and again after turn 800, when it begins to tilt back and forth, which is probably due to space charge coupling the two planes. In the end, the beam has a somewhat uniform density, is not tilted, is not rotating, and is quite intense ($1.5 \times 10^{14}$ particles), so the basic goals of the painting scheme have been achieved. The beam can now be extracted and collided with the target to produce neutrons.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post briefly outlined a method to "paint" a high-intensity proton beam in a ring. One exciting project which is going on right now is to modify the painting method to produce an elliptical, uniform density, rotating beam which approximates the <a href="https://austin-hoover.github.io/blog/accelerators/space%20charge/differential%20equations/publications/2021/05/13/matched_Danilov_dist.html">Danilov distribution</a>. This basically involves changing the slope along with the position of the circulating beam.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>References</strong></p>
<p></p>
<p class="bibliography"></p>
<p><span id="Henderson2014">[1] "The Spallation Neutron Source accelerator system design," <i>Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment</i> <b>763</b>:610â€“673 (2014). https://doi.org/https://doi.org/10.1016/j.nima.2014.03.067.</span></p>
<p><span id="Cathey2018">[2] B. Cathey, S. Cousineau, A. Aleksandrov, &amp; A. Zhukov, "First Six Dimensional Phase Space Measurement of an Accelerator Beam," <i>Phys. Rev. Lett.</i> <b>121</b>:064804 (2018). https://doi.org/10.1103/PhysRevLett.121.064804.</span></p>
<p><span id="Ruggiero1978">[3] A. G. Ruggiero, "Are We Beating Liouvilleâ€™s Theorem?," <i>eConf</i> <b>C7803272</b>:123 (1978).</span></p>
<p><span id="Cousineau2017">[4] S. Cousineau, A. Rakhman, M. Kay, A. Aleksandrov, V. Danilov, T. Gorlov, Y. Liu, M. Plum, A. Shishlo, &amp; D. Johnson, "First Demonstration of Laser-Assisted Charge Exchange for Microsecond Duration Beams," <i>Phys. Rev. Lett.</i> <b>118</b>:074801 (2017). https://doi.org/10.1103/PhysRevLett.118.074801.</span></p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="austin-hoover/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/accelerators/space%20charge/2021/05/27/painting_a_particle_beam.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Writings about physics and related topics.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/austin-hoover" title="austin-hoover"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
