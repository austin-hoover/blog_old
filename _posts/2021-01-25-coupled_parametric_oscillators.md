---
keywords: fastai
description: Studying particle motion in the presence of time-dependent coupled linear forces.
title: Coupled Parametric Oscillators
toc: true 
badges: false
comments: true
categories: [physics]
image: images/chart-preview.png
nb_path: _notebooks/2021-01-25-coupled_parametric_oscillators.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-01-25-coupled_parametric_oscillators.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In a <a href="https://austin-hoover.github.io/blog/physics/accelerators/2021/01/21/parametric_oscillators.html">previous post</a> we examined the solutions to an equation of motion describing a parametric oscillator, which is a harmonic oscillator whose physical properties are time-dependent (but not dependent on the state of the oscillator). This problem was motivated by describing the transverse oscillations of a particle in an accelerator. In this post, the treatment will be extended to a <em>coupled</em> parametric oscillator. Basically, we are trying to solve the following equation of motion:</p>
<p>{% raw %}
$$x'' + k_{11}(s)x + k_{13}(s)y + k_{14}(s)y',$$
{% endraw %}
{% raw %}
$$y'' + k_{33}(s)y + k_{31}(s)x + k_{32}(s)x',$$
{% endraw %}</p>
<p>where the prime denotes differentiation with respect to $s$. We also assume that each of the $k_{ij}$ coefficients are periodic, so $k_{ij}(s + L) = k_{ij}(s)$ for some $L$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Motivation">Motivation<a class="anchor-link" href="#Motivation"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The previous post discussed dipole and quadrupole magnetic fields, which have the special property that their fields depend linearly on $x$ and $y$, and are also uncoupled. Of course there are many other configurations possible. First, consider a solenoid magnet:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html max-width="400" file="/blog/images/copied_from_nb/images_2021-01-25/solenoid.jpg" %}</p>
<figcaption>Credit: brilliant.org</figcaption>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The field within the coils points in the longitudinal direction, and is approximatly constant ($\mathbf{B}_{sol} = B_0\hat{s}$). Plugging this into the Lorentz force equation we find:</p>
<p>{% raw %}
$$\dot{\mathbf{v}} = \frac{q}{m} \mathbf{v} \times \mathbf{B} = \frac{qB_0}{m}\left({v_y\hat{x} - v_x\hat{y}}\right).$$
{% endraw %}</p>
<p>This means the motion in $x$ depends on the velocity in $y$, and vice versa, so this will contribute to $k_{14}$ and $k_{32}$. Next we can consider transverse magnetic fields, for which the general expression can be written as</p>
<p>{% raw %}
$$B_y + iB_x = B_{ref}\sum_{n=1}^{\infty}\left({B_n + iA_n}\right)\left(\frac{x + iy}{R_{ref}}\right)^{n-1}.$$
{% endraw %}</p>
<p>$B_{ref}$ and $R_{ref}$ are a reference field strength and radius, respectively; just consider them to be constants. We then have the normal multiple coefficients $B_n$, and the skew multipole coefficients $A_n$. The field lines corresponding to the first few normal multipole coefficients are shown below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>
{% include image.html file="/blog/images/copied_from_nb/images_2021-01-25/multipoles.png" %}</p>
<p><figcaption>Credit: Jeff Holmes</figcaption>
<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The skew multipole terms are found by rotating these fields by 45 degrees. We won't deal with anything higher than $n = 2$, since these fields contain nonlinear terms. What we will focus on is $A_2$, the skew quadrupole coefficient. This coefficient is present whenever a quadrupole magnet is tilted in the transverse plane; the result is a coupling between the motion in one plane and the position in the other, which contributes to the $k_{13}$ and $k_{31}$ terms.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Approach">Approach<a class="anchor-link" href="#Approach"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us review the approach we took in analysing the 1D parametric oscillator. We observed that the particles travel along the boundary of an ellipse in 2D phase space, the area of which is a constant of the motion (we will denote this area by $\epsilon_x$). To understand the motion, we just need to know the dimensions and orientation of this ellipse, as well as the location of the particle on the ellipse boundary. The former is determined from the parameters: $\alpha_x$ and $\beta_x$, and the latter by the phase $\mu_x$. All the subscripts can be replaced by $y$ to handle the vertical motion.</p>
<p>We can also write a transfer matrix $\mathbf{M}$ from these parameters which connects the initial and final phase space coordinates after tracking through one period. This matrix can be factored into three steps: 1) deformation of the ellipse into a circle (while preserving its area), 2) rotation around the circle by the phase advance, 3) undo the original transformation.</p>
<p>Maybe we can do a similar thing for coupled motion. We now have four dimensions in phase space: $x$, $y$, $x'$, and $y'$, so we need to observe each of the 2D projections of this space (six in total). Maybe we can do something similar to the 1D case... let's track a particle in a lattice with a nonzero skew quadrupole coefficient, plotting its coordinates at one position in the lattice after every period.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># anim = myanim.corner_onepart(</span>
<span class="c1">#     X, </span>
<span class="c1">#     dims=&#39;all&#39;, </span>
<span class="c1">#     figsize=8, </span>
<span class="c1">#     show_history=True, </span>
<span class="c1">#     text_fmt=&#39;Period = {}&#39;,</span>
<span class="c1">#     fps=30,</span>
<span class="c1">#     label_kws=dict(fontsize=&#39;large&#39;),</span>
<span class="c1">#     text_kws=dict(fontsize=&#39;large&#39;),</span>
<span class="c1">#     grid_kws=dict(alpha=0.11),</span>
<span class="c1">#     history_kws=dict(s=5, alpha=0.2, color=&#39;black&#39;),</span>
<span class="c1">#     color=&#39;black&#39;,</span>
<span class="c1">#     s=10</span>
<span class="c1"># )</span>
<span class="c1"># anim</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The particle traces interesting donut-like shapes instead of ellipses. There are clearly two frequencies involved, which we see if we plot the $x$ and $y$ position vs period number and take the FFT. This is typical of a coupled oscillator. Usually a coupled oscillator is understood as the superposition of <a href="https://en.wikipedia.org/wiki/Normal_mode">normal modes</a>, each of which corresponds to a single frequency. For example, consider two masses connected with a spring. The system has a <em>breathing mode</em>, in which masses move in opposite directions, and a <em>sloshing mode</em>, in which the masses move in the same direction. The motion is simply the sum of these two modes. We will try to do something similar for a coupled parameteric oscillator.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transfer-matrix-eigenvectors">Transfer matrix eigenvectors<a class="anchor-link" href="#Transfer-matrix-eigenvectors"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion"> </a></h2>
</div>
</div>
</div>
</div>
 

